<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      NVIDIA GPUDirect storage에 대해 &middot; Yu's Tech 블로그
    
  </title>

  <!-- BOOTSTRAP -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

  <!-- CODE BLOCK FONT -->
  <link href="http://cdn.jsdelivr.net/gh/joungkyun/font-d2coding/d2coding.css" rel="stylesheet" type="text/css">

  <!-- SCROLLSPY-->
  <script src="https://unpkg.com/scrollnav@3.0.2/dist/scrollnav.min.umd.js"></script>
  <link rel="stylesheet" href="/assets/css/style.css">

  
  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

    <!-- syntax.css -->
  <link rel="stylesheet" href="/assets/css/syntax.css">

  <!-- font -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap" rel="stylesheet">
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-146052-15', 'getpoole.com');
    ga('send', 'pageview');
  </script>

</head>

  <!--
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    }
  });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>



  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>You will never know until you try.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home <small class="text-info">19</small></a>

    

    <!-- 
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
    
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/category/Algorithm/index.html">Algorithm</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/category/Deep%20learning/index.html">Deep learning</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/category/HPC/index.html">HPC</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/category/Lecture/index.html">Lecture</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/category/Mongodb/index.html">Mongodb</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/category/OpenCL/index.html">OpenCL</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/category/Operating%20system/index.html">Operating system</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/category/Python/index.html">Python</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/category/Spark/index.html">Spark</a>
        
      
    
      
        
      
    
      
        
      
    
 -->
    
      <a class = "sidebar-nav-item " href="/category/Python/index.html">Python <small class="text-info">3</small></a>  
    <!--<a class="sidebar-nav-item" href="/category/Python/index.html">Python</a>  <small class="text-muted">3</small>-->
    
      <a class = "sidebar-nav-item " href="/category/Mongodb/index.html">Mongodb <small class="text-info">1</small></a>  
    <!--<a class="sidebar-nav-item" href="/category/Mongodb/index.html">Mongodb</a>  <small class="text-muted">1</small>-->
    
      <a class = "sidebar-nav-item " href="/category/Spark/index.html">Spark <small class="text-info">1</small></a>  
    <!--<a class="sidebar-nav-item" href="/category/Spark/index.html">Spark</a>  <small class="text-muted">1</small>-->
    
      <a class = "sidebar-nav-item " href="/category/Algorithm/index.html">Algorithm <small class="text-info">4</small></a>  
    <!--<a class="sidebar-nav-item" href="/category/Algorithm/index.html">Algorithm</a>  <small class="text-muted">4</small>-->
    
      <a class = "sidebar-nav-item " href="/category/Deep learning/index.html">Deep learning <small class="text-info">1</small></a>  
    <!--<a class="sidebar-nav-item" href="/category/Deep learning/index.html">Deep learning</a>  <small class="text-muted">1</small>-->
    
      <a class = "sidebar-nav-item " href="/category/OpenCL/index.html">OpenCL <small class="text-info">1</small></a>  
    <!--<a class="sidebar-nav-item" href="/category/OpenCL/index.html">OpenCL</a>  <small class="text-muted">1</small>-->
    
      <a class = "sidebar-nav-item " href="/category/Operating system/index.html">Operating system <small class="text-info">1</small></a>  
    <!--<a class="sidebar-nav-item" href="/category/Operating system/index.html">Operating system</a>  <small class="text-muted">1</small>-->
    
      <a class = "sidebar-nav-item " href="/category/Lecture/index.html">Lecture <small class="text-info">6</small></a>  
    <!--<a class="sidebar-nav-item" href="/category/Lecture/index.html">Lecture</a>  <small class="text-muted">6</small>-->
    
      <a class = "sidebar-nav-item " href="/category/HPC/index.html">HPC <small class="text-info">1</small></a>  
    <!--<a class="sidebar-nav-item" href="/category/HPC/index.html">HPC</a>  <small class="text-muted">1</small>-->
    
    
<!--
    <a class="sidebar-nav-item" href="https://github.com/Yujaeseo/Yujaeseo.github.io.git/archive/v1.0.0.zip">Download</a>
    <a class="sidebar-nav-item" href="https://github.com/Yujaeseo/Yujaeseo.github.io.git">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.0.0</span>
-->
  </nav>
<!--
  <div class="sidebar-item">
    <p>
      &copy; 2022. All rights reserved.
    </p>
  </div>
-->
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Yu's Tech 블로그</a>
            <small>프로그래밍 이야기</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">

  <h1 class="post-title">NVIDIA GPUDirect storage에 대해</h1>
  <span class="post-date">07 Aug 2022</span>
  
    
      
        <span class="badge badge-dark">NVIDIA</span>
      
    
      
        <span class="badge badge-dark">GPU</span>
      
    
      
        <span class="badge badge-dark">HPC</span>
      
    
      
        <span class="badge badge-dark">Deep learning</span>
      
    
      
        <span class="badge badge-dark">Machine learning</span>
      
    
  
  <article id="main-content" class="main-content">
    <hr />

<p><br /><br /></p>

<h2 id="nvidia-gpudirect"><strong>NVIDIA GPUDirect</strong></h2>

<ul>
  <li>NVIDIA GPUDirect란 NVIDIA data center GPU의 data movement와 access 속도를 높여주는 기술이다. AI를 위해 많은 기업들이 고성능 GPU 서버를 구축하고 있고, 높은 flops를 가지는 GPU의 성능을 활용하기 위해서는 높은 IO bandwidth가 뒷받침되어야 한다. 아래의 이미지는 NVIDIA 기술 세미나에서 인용한 HP의 슬라이드이다. Computer architecture 각 구성 요소들의 처리 속도를 사람의 걸음수로 환산하여 비교한 자료이다. CPU 프로세서의 처리 속도를 한 걸음이라고 했을 때, system memory (DRAM)와 SSD (Flash)의 IO 속도를 각각 100, 200,000 걸음으로 환산할 수 있다. CPU 처리 속도에 비해 주변 장치의 IO 속도가 훨씬 느리기 때문에 processor의 빠른 처리 속도를 십분 활용하기 위해서 IO 속도를 높이는 것이 무엇보다 중요하다고 할 수 있다.</li>
</ul>

<p><br /></p>

<p><img src="/assets/img/Lecture/Introduction to Model Serving/Introduction to Model Serving Infrastructure/image-20220807223108967.png" alt="image-20220807223108967" width="100%" height="100%" class="align-center" />
  <em>Figure 1. Computer architecture (<a href="https://www.youtube.com/watch?v=ZMf64oB_arY">source</a>)</em></p>

<p><br /></p>

<ul>
  <li>NIVIDIA GPU의 빠른 처리 속도를 활용해 시스템 성능을 극대화하기 위해 GPUDirect라는 기술을 개발하였고, storage access 최적화를 위한 GPUDirect Storage, network adapter access 최적화를 위한 GPUdirect RDMA, GPU 간 통신 최적화를 위한 GPUDirect P2P를 비롯한 다양한 기술들이 포함되어 있다. 그중 스토리지와의 data movement 속도를 높여주는 NVIDIA GPUDirect Storage(GDS)에 대해 알아보고자 한다.</li>
</ul>

<p><br /><br /></p>

<h2 id="nvidia-gpudirect-storage-gds"><strong>NVIDIA GPUDirect storage (GDS)</strong></h2>

<ul>
  <li>GDS는 local 또는 remote storage(e.g. NVMe or NVMe over Fabric)와 GPU 간 direct path를 이용하여 빠르게 통신할 수 있도록 해주는 기술이다. 이를 통해 IO 시 CPU에서 발생하는 bottleneck을 줄여줄 수 있게된다. GDS가 없을 때는 local 또는 remote storage에서 데이터를 불러올 때 CPU를 거쳐야만 했다. 즉 CPU의 low memory에 있는 bounce buffer에 storage에서 읽은 데이터가 쌓이고, 해당 데이터를 high memory에 copy한 후 해당 데이터가 GPU 메모리로 이동하는 방식이였다. 반면에 GDS를 사용하면 아래의 그림과 같이 CPU를 거치지 않고 storage와 GPU간에 direct하게 통신할 수 있게 된다. GPU와 storage 간의 DMA (Direct Memory Access)를 통해 CPU의 불필요한 memory copy를 줄일 수 있게 되며, 통신을 위해 거치는 data path가 짧아져 data transfer에 소요되는 시간이 줄게된다.</li>
</ul>

<p><img src="/assets/img/Lecture/Introduction to Model Serving/Introduction to Model Serving Infrastructure/GPUDirect Storage data path.png" alt="GPUDirect Storage data path" width="100%" height="100%" class="align-center" />
  <em>Fig 2. GPUDirect Storage data path (<a href="https://nvdam.widen.net/s/k8vrp9xkft/tech-overview-magnum-io-1790750-r5-web">source</a>)</em></p>

<p><br /><br /></p>

<h2 id="performance"><strong>Performance</strong></h2>

<ul>
  <li>아래의 그래프는 NVIDIA 자체 gdsio benchmarking tool을 이용해서 bandwidth와 cpu utilization을 측정한 자료이다. 자료에 따르면 GDS를 사용하지 않았을 때(CPU-GPU_READ)에 비해 bandwidth는 최대 1.5X 향상되었으며, CPU utilization의 경우 최대 2.8X 향상되었음을 확인할 수 있다.</li>
</ul>

<p><img src="/assets/img/Lecture/Introduction to Model Serving/Introduction to Model Serving Infrastructure/The benefits of using GDS with the gdsio benchmarking tool.png" alt="The benefits of using GDS with the gdsio benchmarking tool" width="100%" height="100%" class="align-center" />
  <em>Fig 3. The benefits of using GDS with the gdsio benchmarking tool (<a href="https://nvdam.widen.net/s/k8vrp9xkft/tech-overview-magnum-io-1790750-r5-web">source</a>)</em></p>

<p><br /></p>

<ul>
  <li>Weather pattern을 확인하는 climate simulation deep learning 모델에 GDS, DALI (Nvidia data loading library), deepCAM를 적용하여 inference 성능을 측정했을 때 최대 6.6X의 성능 향상이 있었다. (GDS만 적용했을 때의 성능 개선치만 볼 수 있었다면 좋았을 것 같다).</li>
</ul>

<p><img src="/assets/img/Lecture/Introduction to Model Serving/Introduction to Model Serving Infrastructure/Performance benchmarking done for DeepCAM Inference.png" alt="Performance benchmarking done for DeepCAM Inference" width="100%" height="100%" class="align-center" />
  <em>Fig 4. Performance benchmarking done for DeepCAM Inference using standard GDS configuration in DGX A100 (<a href="https://nvdam.widen.net/s/k8vrp9xkft/tech-overview-magnum-io-1790750-r5-web">source</a>)</em></p>

<p><br /><br /></p>


  </article>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/hpc/2022/08/07/NVIDIA-GPUDirect-storage/">
            NVIDIA GPUDirect storage에 대해
            <small>07 Aug 2022</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/lecture/2022/07/29/Deploying-Machine-Learning-Models-in-Production-Introduction-to-Model-Serving-Infrastructure/">
            Deploying Machine Learning Models in Production_Introduction to Model Serving Infrastructure
            <small>29 Jul 2022</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/lecture/2022/08/02/Deploying-Machine-Learning-Models-in-Production-Model-Servers-Tensorflow-Serving/">
            Deploying Machine Learning Models in Production_Model Servers-TensorFlow Serving
            <small>02 Aug 2022</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


  <div id="disqus_thread"></div>
  <script>
      /**
      *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
      *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
      /*
      var disqus_config = function () {
      this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      */
      (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://yujaeseo-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
      })();


    // const content = document.querySelector(".main-content");

    // scrollnav.init(content,{
    //   debug: false,
    //   easingStyle: 'easeOutQuint',
    //   sections: ($('.post-content > h1').length>0) ? 'h1' : 'h2',
    //   subSections: ($('.post-content > h1').length>0) ? 'h2' : 'h3'
    // });

    // var sideNav = function(){
    //   var mainRect = document.getElementById('main-content').getBoundingClientRect();
    //   $('nav.scroll-nav').css('left', mainRect.right + 50 + 'px');
    // }

    // sideNav();
    // window.addEventListener("resize", sideNav);

</script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
  <script>
    const content = document.querySelector(".main-content");
    
    scrollnav.init(content,{
      debug: false,
      updateHistory: false,
      // easingStyle: 'easeOutQuint',
      sections: ($('.post-content > h1').length>0) ? 'h1' : 'h2',
      subSections: ($('.post-content > h1').length>0) ? 'h2' : 'h3'
    });
    
    var sideNav = function(){
      var mainRect = document.getElementById('main-content').getBoundingClientRect();
      $('nav.scroll-nav').css('left', mainRect.right + 50 + 'px');
    }
    
    sideNav();
    window.addEventListener("resize", sideNav);
    
   

    
    // window.addEventListener('load', (event) => {
    //   console.log('page is fully loaded');
    //   scrollnav.updatePositions();
  
    // });

  </script>
</html>
